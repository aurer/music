const {
  h,
  Component
} = preact;

class Track extends Component {
  remapTrack(track) {
    return {
      name: track.name,
      artist: track.artist['#text'],
      album: track.album['#text'],
      image: this.findImage(track.image),
      time: this.trackTime(track)
    };
  }

  trackTime(track) {
    let time = 'a while ago';

    if (track['@attr'] && track['@attr'].nowplaying) {
      time = 'now';
    }

    if (track.date) {
      time = moment.unix(track.date.uts).fromNow();
    }

    return time;
  }

  findImage(trackImages) {
    let image = trackImages.reverse().find(image => image['#text'] != '');
    return image ? image['#text'] : 'data:image/svg+xml;<svg xmlns="http://www.w3.org/2000/svg" width="300" height="300"><rect fill="#333" x="0" y="0" width="300" height="300" /></svg>';
  }

  render(props) {
    let track = this.remapTrack(props.track);
    let style = {
      backgroundImage: 'url(' + track.image + ')'
    };
    let searchUri = `spotify:search:${track.artist}%20${track.name}`;
    return h("div", {
      class: "Track"
    }, h("div", {
      class: "Track-image"
    }, h("img", {
      src: track.image,
      width: "300",
      height: "300"
    })), h("div", {
      class: "Track-info"
    }, h("h2", {
      class: "Track-title"
    }, track.name), h("p", {
      class: "Track-artist"
    }, track.artist), h("small", {
      class: "Track-date"
    }, track.time)));
  }

}

export default Track;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvVHJhY2suanMiXSwibmFtZXMiOlsiaCIsIkNvbXBvbmVudCIsInByZWFjdCIsIlRyYWNrIiwicmVtYXBUcmFjayIsInRyYWNrIiwibmFtZSIsImFydGlzdCIsImFsYnVtIiwiaW1hZ2UiLCJmaW5kSW1hZ2UiLCJ0aW1lIiwidHJhY2tUaW1lIiwibm93cGxheWluZyIsImRhdGUiLCJtb21lbnQiLCJ1bml4IiwidXRzIiwiZnJvbU5vdyIsInRyYWNrSW1hZ2VzIiwicmV2ZXJzZSIsImZpbmQiLCJyZW5kZXIiLCJwcm9wcyIsInN0eWxlIiwiYmFja2dyb3VuZEltYWdlIiwic2VhcmNoVXJpIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNO0FBQUVBLEVBQUFBLENBQUY7QUFBS0MsRUFBQUE7QUFBTCxJQUFtQkMsTUFBekI7O0FBRUEsTUFBTUMsS0FBTixTQUFvQkYsU0FBcEIsQ0FBOEI7QUFDN0JHLEVBQUFBLFVBQVUsQ0FBQ0MsS0FBRCxFQUFRO0FBQ2pCLFdBQU87QUFDTkMsTUFBQUEsSUFBSSxFQUFFRCxLQUFLLENBQUNDLElBRE47QUFFTkMsTUFBQUEsTUFBTSxFQUFFRixLQUFLLENBQUNFLE1BQU4sQ0FBYSxPQUFiLENBRkY7QUFHTkMsTUFBQUEsS0FBSyxFQUFFSCxLQUFLLENBQUNHLEtBQU4sQ0FBWSxPQUFaLENBSEQ7QUFJTkMsTUFBQUEsS0FBSyxFQUFFLEtBQUtDLFNBQUwsQ0FBZUwsS0FBSyxDQUFDSSxLQUFyQixDQUpEO0FBS05FLE1BQUFBLElBQUksRUFBRSxLQUFLQyxTQUFMLENBQWVQLEtBQWY7QUFMQSxLQUFQO0FBT0E7O0FBRURPLEVBQUFBLFNBQVMsQ0FBQ1AsS0FBRCxFQUFRO0FBQ2hCLFFBQUlNLElBQUksR0FBRyxhQUFYOztBQUVBLFFBQUlOLEtBQUssQ0FBQyxPQUFELENBQUwsSUFBa0JBLEtBQUssQ0FBQyxPQUFELENBQUwsQ0FBZVEsVUFBckMsRUFBaUQ7QUFDaERGLE1BQUFBLElBQUksR0FBRyxLQUFQO0FBQ0E7O0FBRUQsUUFBSU4sS0FBSyxDQUFDUyxJQUFWLEVBQWdCO0FBQ2ZILE1BQUFBLElBQUksR0FBR0ksTUFBTSxDQUFDQyxJQUFQLENBQVlYLEtBQUssQ0FBQ1MsSUFBTixDQUFXRyxHQUF2QixFQUE0QkMsT0FBNUIsRUFBUDtBQUNBOztBQUVELFdBQU9QLElBQVA7QUFDQTs7QUFFREQsRUFBQUEsU0FBUyxDQUFDUyxXQUFELEVBQWM7QUFDdEIsUUFBSVYsS0FBSyxHQUFHVSxXQUFXLENBQUNDLE9BQVosR0FBc0JDLElBQXRCLENBQTJCWixLQUFLLElBQUlBLEtBQUssQ0FBQyxPQUFELENBQUwsSUFBa0IsRUFBdEQsQ0FBWjtBQUNBLFdBQU9BLEtBQUssR0FDVEEsS0FBSyxDQUFDLE9BQUQsQ0FESSxHQUVULHFKQUZIO0FBR0E7O0FBRURhLEVBQUFBLE1BQU0sQ0FBQ0MsS0FBRCxFQUFRO0FBQ2IsUUFBSWxCLEtBQUssR0FBRyxLQUFLRCxVQUFMLENBQWdCbUIsS0FBSyxDQUFDbEIsS0FBdEIsQ0FBWjtBQUNBLFFBQUltQixLQUFLLEdBQUc7QUFBRUMsTUFBQUEsZUFBZSxFQUFFLFNBQVNwQixLQUFLLENBQUNJLEtBQWYsR0FBdUI7QUFBMUMsS0FBWjtBQUNBLFFBQUlpQixTQUFTLEdBQUksa0JBQWlCckIsS0FBSyxDQUFDRSxNQUFPLE1BQUtGLEtBQUssQ0FBQ0MsSUFBSyxFQUEvRDtBQUNBLFdBQ0M7QUFBSyxNQUFBLEtBQUssRUFBQztBQUFYLE9BQ0M7QUFBSyxNQUFBLEtBQUssRUFBQztBQUFYLE9BQ0M7QUFBSyxNQUFBLEdBQUcsRUFBRUQsS0FBSyxDQUFDSSxLQUFoQjtBQUF1QixNQUFBLEtBQUssRUFBQyxLQUE3QjtBQUFtQyxNQUFBLE1BQU0sRUFBQztBQUExQyxNQURELENBREQsRUFJQztBQUFLLE1BQUEsS0FBSyxFQUFDO0FBQVgsT0FDQztBQUFJLE1BQUEsS0FBSyxFQUFDO0FBQVYsT0FBeUJKLEtBQUssQ0FBQ0MsSUFBL0IsQ0FERCxFQUVDO0FBQUcsTUFBQSxLQUFLLEVBQUM7QUFBVCxPQUF5QkQsS0FBSyxDQUFDRSxNQUEvQixDQUZELEVBR0M7QUFBTyxNQUFBLEtBQUssRUFBQztBQUFiLE9BQTJCRixLQUFLLENBQUNNLElBQWpDLENBSEQsQ0FKRCxDQUREO0FBWUE7O0FBaEQ0Qjs7QUFtRDlCLGVBQWVSLEtBQWYiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IGgsIENvbXBvbmVudCB9ID0gcHJlYWN0O1xuXG5jbGFzcyBUcmFjayBleHRlbmRzIENvbXBvbmVudCB7XG5cdHJlbWFwVHJhY2sodHJhY2spIHtcblx0XHRyZXR1cm4ge1xuXHRcdFx0bmFtZTogdHJhY2submFtZSxcblx0XHRcdGFydGlzdDogdHJhY2suYXJ0aXN0WycjdGV4dCddLFxuXHRcdFx0YWxidW06IHRyYWNrLmFsYnVtWycjdGV4dCddLFxuXHRcdFx0aW1hZ2U6IHRoaXMuZmluZEltYWdlKHRyYWNrLmltYWdlKSxcblx0XHRcdHRpbWU6IHRoaXMudHJhY2tUaW1lKHRyYWNrKVxuXHRcdH07XG5cdH1cblxuXHR0cmFja1RpbWUodHJhY2spIHtcblx0XHRsZXQgdGltZSA9ICdhIHdoaWxlIGFnbyc7XG5cblx0XHRpZiAodHJhY2tbJ0BhdHRyJ10gJiYgdHJhY2tbJ0BhdHRyJ10ubm93cGxheWluZykge1xuXHRcdFx0dGltZSA9ICdub3cnO1xuXHRcdH1cblxuXHRcdGlmICh0cmFjay5kYXRlKSB7XG5cdFx0XHR0aW1lID0gbW9tZW50LnVuaXgodHJhY2suZGF0ZS51dHMpLmZyb21Ob3coKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGltZTtcblx0fVxuXG5cdGZpbmRJbWFnZSh0cmFja0ltYWdlcykge1xuXHRcdGxldCBpbWFnZSA9IHRyYWNrSW1hZ2VzLnJldmVyc2UoKS5maW5kKGltYWdlID0+IGltYWdlWycjdGV4dCddICE9ICcnKTtcblx0XHRyZXR1cm4gaW1hZ2Vcblx0XHRcdD8gaW1hZ2VbJyN0ZXh0J11cblx0XHRcdDogJ2RhdGE6aW1hZ2Uvc3ZnK3htbDs8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjMwMFwiIGhlaWdodD1cIjMwMFwiPjxyZWN0IGZpbGw9XCIjMzMzXCIgeD1cIjBcIiB5PVwiMFwiIHdpZHRoPVwiMzAwXCIgaGVpZ2h0PVwiMzAwXCIgLz48L3N2Zz4nO1xuXHR9XG5cblx0cmVuZGVyKHByb3BzKSB7XG5cdFx0bGV0IHRyYWNrID0gdGhpcy5yZW1hcFRyYWNrKHByb3BzLnRyYWNrKTtcblx0XHRsZXQgc3R5bGUgPSB7IGJhY2tncm91bmRJbWFnZTogJ3VybCgnICsgdHJhY2suaW1hZ2UgKyAnKScgfTtcblx0XHRsZXQgc2VhcmNoVXJpID0gYHNwb3RpZnk6c2VhcmNoOiR7dHJhY2suYXJ0aXN0fSUyMCR7dHJhY2submFtZX1gO1xuXHRcdHJldHVybiAoXG5cdFx0XHQ8ZGl2IGNsYXNzPVwiVHJhY2tcIj5cblx0XHRcdFx0PGRpdiBjbGFzcz1cIlRyYWNrLWltYWdlXCI+XG5cdFx0XHRcdFx0PGltZyBzcmM9e3RyYWNrLmltYWdlfSB3aWR0aD1cIjMwMFwiIGhlaWdodD1cIjMwMFwiIC8+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwiVHJhY2staW5mb1wiPlxuXHRcdFx0XHRcdDxoMiBjbGFzcz1cIlRyYWNrLXRpdGxlXCI+e3RyYWNrLm5hbWV9PC9oMj5cblx0XHRcdFx0XHQ8cCBjbGFzcz1cIlRyYWNrLWFydGlzdFwiPnt0cmFjay5hcnRpc3R9PC9wPlxuXHRcdFx0XHRcdDxzbWFsbCBjbGFzcz1cIlRyYWNrLWRhdGVcIj57dHJhY2sudGltZX08L3NtYWxsPlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdDwvZGl2PlxuXHRcdCk7XG5cdH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgVHJhY2s7XG4iXSwiZmlsZSI6ImNvbXBvbmVudHMvVHJhY2suanMifQ==